<section class="custom-container">
  <div class="px-8 py-6 sm:px-28 sm:py-20 max-w-[722px] rounded-xl bg-white">
    <!-- Loading state while verifying token -->
    @if (isVerifying) {
      <div class="text-center py-8">
        <div
          class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"
        ></div>
        <p class="mt-4 text-gray-600">{{ 'RESET_PASSWORD.VERIFYING_LINK' | translate }}</p>
      </div>
    }

    <!-- Error state for invalid token -->
    @else if (!isValidToken) {
      <!-- Add your code Here broo -->
      <div class="text-center py-8">
        <div
          class="flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full"
        >
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </div>
        <h3 class="text-lg font-medium text-red-800 mb-2">
          {{ 'RESET_PASSWORD.INVALID_LINK_TITLE' | translate }}
        </h3>
        <p class="text-red-600 mb-4">{{ errorMessage }}</p>
        <button type="button" class="btn green-btn" (click)="onCancel()">
          {{ 'RESET_PASSWORD.BACK_TO_LOGIN' | translate }}
        </button>
      </div>
    }

    <!-- Valid token - show password reset form -->
    @else if (isValidToken) {
      <h1
        class="text-[24px] sm:text-[30px] md:text-[36px] lg:text-[42px] font-bold text-[#161616] mb-[32px] sm:mb-[48px]"
      >
        {{ 'RESET_PASSWORD.NEW_PASSWORD_TITLE' | translate }}
      </h1>
      <form [formGroup]="newPasswordForm">
        @if (errorMessage) {
          <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
            <p class="text-red-600 text-sm">{{ errorMessage }}</p>
          </div>
        }

        <div class="relative w-full mb-5">
          <label for="newPassword" class="text-sm font-normal text-[#161616] block mb-2">
            {{ 'RESET_PASSWORD.NEW_PASSWORD_LABEL' | translate }}
          </label>
          <p-password
            id="newPassword"
            formControlName="newPassword"
            class="peer"
            type="password"
            [feedback]="false"
            [toggleMask]="true"
            [placeholder]="'RESET_PASSWORD.NEW_PASSWORD_LABEL' | translate"
            fluid="true"
          />
          <span
            class="absolute bottom-0 left-1/2 w-0 h-0.5 bg-black transition-all duration-500 peer-focus:left-0 peer-focus:w-full"
          ></span>
          <app-validation-messages [control]="newPasswordControl"></app-validation-messages>
        </div>

        <div class="relative w-full">
          <label for="confirmNewPassword" class="text-sm font-normal text-[#161616] block mb-2">
            {{ 'RESET_PASSWORD.CONFIRM_NEW_PASSWORD_LABEL' | translate }}
          </label>
          <p-password
            id="confirmNewPassword"
            formControlName="confirmPassword"
            class="peer"
            type="password"
            [feedback]="false"
            [toggleMask]="true"
            [placeholder]="'RESET_PASSWORD.CONFIRM_NEW_PASSWORD_LABEL' | translate"
            fluid="true"
          />
          <span
            class="absolute bottom-0 left-1/2 w-0 h-0.5 bg-black transition-all duration-500 peer-focus:left-0 peer-focus:w-full"
          ></span>
          <app-validation-messages [control]="confirmPasswordControl"></app-validation-messages>
          <!-- Password mismatch error -->
          @if (newPasswordForm.errors?.['passwordMismatch'] && confirmPasswordControl.touched) {
            <span class="validation-message">
              {{ 'PROFILE_PAGE.PASSWORD_MISMATCH' | translate }}
            </span>
          }
        </div>

        <div class="mt-10 flex items-center justify-between flex-wrap gap-4">
          <button type="submit" (click)="onSubmit()" class="btn green-btn w-full">
            {{ 'RESET_PASSWORD.SET_PASSWORD_BTN' | translate }}
          </button>
          <button
            type="button"
            class="btn gray-btn inline-flex items-center justify-center min-h-[40px] px-3 rounded text-[14px] font-medium hover:bg-[#f1f1f1] transition w-full border border-[#d2d6db]"
            (click)="onCancel()"
          >
            {{ 'COMMON.CANCEL' | translate }}
          </button>
        </div>
      </form>
    }
  </div>
</section>
